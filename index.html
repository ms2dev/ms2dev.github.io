<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FL Studio 破解版整合</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1e1e1e;
            color: #ffffff;
            margin: 0;
            padding: 0;
        }
        header {
            text-align: center;
            padding: 50px 0;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            background-size: cover;
            background-position: center;
            position: relative;
            overflow: hidden;
        }
        header h1 {
            font-size: 3rem;
            margin: 0;
        }
        header p {
            font-size: 1.2rem;
            margin: 20px 0 0;
        }
        .container {
            padding: 30px;
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        .download-link {
            margin: 20px 0;
            padding: 15px 20px;
            background-color: #ff6600;
            color: #fff;
            text-decoration: none;
            border-radius: 8px;
            display: inline-block;
            transition: background-color 0.3s;
        }
        .download-link:hover {
            background-color: #ff4500;
        }
        .download-card {
            margin-bottom: 40px;
            padding: 20px;
            background-color: #2e2e2e;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: left;
            position: relative;
        }
        .download-card h2 {
            margin-top: 0;
            font-size: 1.8rem;
        }
        .download-card p {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .download-card .downloads {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1rem;
            color: #ffcc00;
        }
        footer {
            text-align: center;
            padding: 20px;
            background-color: #1a1a1a;
            position: relative;
        }
        footer p {
            margin: 0;
            font-size: 0.9rem;
            color: #aaa;
        }
        .disclaimer-button {
            background-color: #ff6600;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            display: inline-block;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }
        .modal-content {
            background-color: #333;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            border-radius: 10px;
            color: #fff;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: #fff;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header>
        <h1>FL Studio 破解版整合</h1>
        <p>支持 Windows 和 Mac，提供各版本下载资源</p>
    </header>
    
    <div class="container">
        <div class="download-card">
            <h2>FL Studio Producer Edition v21.1.1 [build 3750] 全插件版</h2>
            <p>适用于 Windows</p>
            <a href="magnet:?xt=urn:btih:B3B69DD393190401EE77EB68C1644FB97B11A7D6" class="download-link" data-id="fl-ape">下载</a>
            <span class="downloads">下载量: <span id="fl-ape-count">0</span> 次</span>
        </div>
        
        <div class="download-card">
            <h2>FL Studio v20.8.3 [build 1574] 制作人版</h2>
            <p>适用于 Mac</p>
            <a href="magnet:?xt=urn:btih:9DFBC445849C11D8C1761615286DE510EE289F48" class="download-link" data-id="fl-pe">下载</a>
            <span class="downloads">下载量: <span id="fl-pe-count">0</span> 次</span>
        </div>
        
        <div class="download-card">
            <h2>FL Studio v20.8.3 [Build 2304] Signature Bundle 进阶版</h2>
            <p>适用于 Windows 和 Mac</p>
            <a href="magnet:?xt=urn:btih:7C922F89C84DF9D65177C91D43F201BF6383B02F" class="download-link" data-id="fl-sbe">下载</a>
            <span class="downloads">下载量: <span id="fl-sbe-count">0</span> 次</span>
        </div>
    </div>
    
    <footer>
        <button class="disclaimer-button" id="disclaimerBtn">免责声明</button>
    </footer>

    <!-- 模态框 -->
    <div id="disclaimerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>免责声明</h2>
            <p>本网站及其所有内容（包括但不限于文本、图像、链接、下载资源等）仅供教育和学习目的使用。我们不对因使用本网站提供的信息或资源而引发的任何直接或间接的损失或损害负责。</p>
            <p>版权与内容: 本网站所提供的下载链接、软件及其他资源均来自互联网，仅供个人学习、研究之用。请在下载后24小时内删除，勿将资源用于商业用途。我们不拥有这些资源的版权，如果您认为我们的内容侵犯了您的版权，请联系我们，我们将立即予以删除。</p>
            <p>第三方链接: 本网站可能包含指向第三方网站的链接。这些链接仅为用户提供方便，并不表示我们对这些网站的内容或使用承担任何责任。访问这些第三方网站是用户自行承担的风险。</p>
            <p>使用风险: 用户应自行判断和承担使用本网站所提供内容的风险。我们不保证本网站内容的准确性、完整性、可靠性、适用性或可用性，并且不承担因内容不准确或遗漏而产生的责任。</p>
            <p>变更与更新: 我们保留随时更改、修改或删除本网站内容的权利，且不事先通知。使用本网站的用户应定期访问此页面，以便及时了解最新的免责声明内容。</p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
        import { getFirestore, doc, getDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

        // Firebase 配置
        const firebaseConfig = {
            apiKey: "AIzaSyBkL-m4ZNhiibmjA9pLslDZrasUsmc8mvY",
            authDomain: "ms2dev-flstudio-count.firebaseapp.com",
            projectId: "ms2dev-flstudio-count",
            storageBucket: "ms2dev-flstudio-count.appspot.com",
            messagingSenderId: "250699042423",
            appId: "1:250699042423:web:51d5140e2982effeedc072",
            measurementId: "G-F4VBC1EJ5Y"
        };

        // 初始化 Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function updateDownloadCount(docId) {
            const docRef = doc(db, "downloads", docId);

            try {
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const count = docSnap.data().count;
                    console.log(`Initial count for ${docId}: ${count}`);
                    // 根据文档ID更新页面上的下载量
                    document.getElementById(`${docId}-count`).textContent = count;
                } else {
                    console.error(`Document ${docId} does not exist`);
                }

                // 监听下载链接的点击事件
                document.querySelector(`[data-id="${docId}"]`).addEventListener('click', async () => {
                    try {
                        await updateDoc(docRef, {
                            count: increment(1)
                        });
                        const newSnap = await getDoc(docRef);
                        // 更新点击后的下载量
                        document.getElementById(`${docId}-count`).textContent = newSnap.data().count;
                        console.log(`Updated count for ${docId}: ${newSnap.data().count}`);
                    } catch (error) {
                        console.error("Error updating document: ", error);
                    }
                });
            } catch (error) {
                console.error("Error getting document: ", error);
            }
        }

        // 调用函数以获取并更新下载量
        updateDownloadCount("fl-ape");
        updateDownloadCount("fl-pe");
        updateDownloadCount("fl-sbe");

        // 弹出窗口脚本
        const modal = document.getElementById("disclaimerModal");
        const btn = document.getElementById("disclaimerBtn");
        const span = document.getElementsByClassName("close")[0];

        // 打开模态框
        btn.onclick = function() {
            modal.style.display = "block";
        }

        // 点击 (x) 关闭模态框
        span.onclick = function() {
            modal.style.display = "none";
        }

        // 点击模态框外区域关闭模态框
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
</body>
</html>
